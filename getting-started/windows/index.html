<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Getting Started &gt; Windows - KDF</title>
    <meta name="generator" content="Hugo 0.49.2" />

    
    <meta name="description" content="Kubernetes Development Framework (KDF)">
    
    <link rel="canonical" href="https://kdf.csco.cloud/getting-started/windows/">
    
    <meta name="author" content="SSO Arch Team">
    

    <meta property="og:url" content="https://kdf.csco.cloud/getting-started/windows/">
    <meta property="og:title" content="KDF">
    <meta property="og:image" content="https://kdf.csco.cloud/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="KDF">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://kdf.csco.cloud/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://kdf.csco.cloud/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://kdf.csco.cloud/fonts/icon.eot');
        src: url('https://kdf.csco.cloud/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://kdf.csco.cloud/fonts/icon.woff')
               format('woff'),
             url('https://kdf.csco.cloud/fonts/icon.ttf')
               format('truetype'),
             url('https://kdf.csco.cloud/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://kdf.csco.cloud/stylesheets/application.css">
    <link rel="stylesheet" href="https://kdf.csco.cloud/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://kdf.csco.cloud/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://kdf.csco.cloud/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://kdf.csco.cloud/stylesheets/hugo-material-docs_application.css">
    
    <script src="https://kdf.csco.cloud/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Getting Started &gt; Windows
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/cisco-sso" title="@cisco-sso on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/cisco-sso/kdf" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://kdf.csco.cloud/images/logo.png">
        </div>
      
      <div class="name">
        <strong>KDF <span class="version">0.1.0</span></strong>
        
          <br>
          cisco-sso/kdf
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-stars">
            <a href="https://github.com/cisco-sso/kdf/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
          <li class="repo-fork">
            <a href="https://github.com/cisco-sso/kdf/fork" target="_blank" title="Fork" data-action="fork">
              <i class="icon icon-fork"></i>Fork on GitHub
	    </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="About" href="https://kdf.csco.cloud/">
	
	About
</a>



  
</li>



<li>
  
    <span class="section">Getting Started</span>
    <ul>
      
        
        



<a  title="Linux" href="https://kdf.csco.cloud/getting-started/linux/">
	
	Linux
</a>



      
        
        



<a  title="Mac" href="https://kdf.csco.cloud/getting-started/mac/">
	
	Mac
</a>



      
        
        



<a class="current" title="Windows" href="https://kdf.csco.cloud/getting-started/windows/">
	
	Windows
</a>


<ul id="scrollspy">
</ul>


      
    </ul>
  
</li>



<li>
  
    



<a  title="Patterns" href="https://kdf.csco.cloud/patterns/">
	
	Patterns
</a>



  
</li>



<li>
  
    



<a  title="Tools" href="https://kdf.csco.cloud/tools/">
	
	Tools
</a>



  
</li>



<li>
  
    <span class="section">Kubernetes</span>
    <ul>
      
        
        



<a  title="Deploying" href="https://kdf.csco.cloud/kubernetes/deploying/">
	
	Deploying
</a>



      
        
        



<a  title="Best Practices" href="https://kdf.csco.cloud/kubernetes/best-practices/">
	
	Best Practices
</a>



      
        
        



<a  title="Monitoring" href="https://kdf.csco.cloud/kubernetes/monitoring/">
	
	Monitoring
</a>



      
        
        



<a  title="Testing" href="https://kdf.csco.cloud/kubernetes/testing/">
	
	Testing
</a>



      
        
        



<a  title="Helm Charts" href="https://kdf.csco.cloud/kubernetes/helm-charts/">
	
	Helm Charts
</a>



      
    </ul>
  
</li>



<li>
  
    



<a  title="Deployment Packages" href="https://kdf.csco.cloud/deployment-packages/">
	
	Deployment Packages
</a>



  
</li>



<li>
  
    



<a  title="Training" href="https://kdf.csco.cloud/training/">
	
	Training
</a>



  
</li>



<li>
  
    



<a  title="Backlog" href="https://kdf.csco.cloud/backlog/">
	
	Backlog
</a>



  
</li>



<li>
  
    



<a  title="Team" href="https://kdf.csco.cloud/team/">
	
	Team
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Contact</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/cisco-sso" target="_blank" title="@cisco-sso on GitHub">
              @cisco-sso on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Getting Started &gt; Windows </h1>

			

<h2 id="intro">Intro</h2>

<p>This getting started guide will walk you through:</p>

<ul>
<li><p>Installing Docker and Kubernetes on your local machine.</p></li>

<li><p>Running a pre-configured Kubernetes development/operations environment which standardizes a team on a common toolset.</p></li>

<li><p>Introducing the &ldquo;framework-deploy&rdquo; pattern which enables teams to easily manage and operate multiple clusters and configurations.</p></li>

<li><p>Deploying a few basic services in Kubernetes such as logging, monitoring, and dashboards.</p></li>

<li><p>Accessing the newly deployed basic service dashboards and introducing introduce their usage.</p></li>
</ul>


<h2 id="requirements">Requirements</h2>

<ul>
<li><strong>Windows 10 Pro</strong> or <strong>Windows 10 Enterprise</strong> is required.</li>
<li>You must execute all PowerShell commands as an administrative user.</li>
<li>8 GB RAM</li>
<li>2 CPU cores</li>
<li>BIOS Settings with Hardware Virtualization Enabled (VTx and VT-d)</li>
</ul>

<h2 id="step-1-chocolatey">Step 1: Chocolatey</h2>

<h3 id="open-a-powershell-terminal-as-administrator">Open a Powershell terminal as <code>Administrator</code>.</h3>

<ul>
<li><code>Windows Search</code> -&gt; <code>Windows PowerShell</code> -&gt; right click <code>Run as Administrator</code></li>
</ul>

<h3 id="install-chocolatey-https-chocolatey-org-install">Install <a href="https://chocolatey.org/install">Chocolatey</a>.</h3>

<pre><code class="language-bash"># Windows Powershell as Administrator
Set-ExecutionPolicy Bypass -Scope Process -Force
iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
</code></pre>

<h2 id="step-2-docker">Step 2: Docker</h2>

<h3 id="install-docker-for-windows-https-docs-docker-com-docker-for-windows-release-notes">Install <a href="https://docs.docker.com/docker-for-windows/release-notes/">Docker for Windows</a>.</h3>

<pre><code class="language-bash"># Windows Powershell as Administrator
choco install -y docker-for-windows
</code></pre>

<ul>
<li><em>If</em> at any point during these instructions you receive an undocumented
prompt of Docker requesting elevated permissions, please select the
<em>Affirmative</em> answer.</li>
</ul>

<h3 id="start-docker">Start Docker.</h3>

<ul>
<li>Windows Search -&gt; <code>Docker For Windows</code> -&gt; ( <code>Enter</code>)</li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-startmenu.png" alt="docker-startmenu" /></p>

<ul>
<li><em>If</em> you receive a prompt to enable Hyper-V, then enable it by clicking <code>Ok</code>.
This will restart your computer, at which point you will have to start Docker
for Windows again by following the prior step.</li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-hyperv.png" alt="docker-hyperv" /></p>

<ul>
<li><p>The Docker icon should now be displayed in the taskbar tray.</p></li>

<li><p>Open the Docker menu by right clicking the Docker icon and selecting <code>Settings</code>.</p></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-tray-icon-settings.png" alt="docker-tray-icon-settings" /></p>

<ul>
<li>On the <code>General</code> tab:

<ul>
<li>Toggle on <code>Start Docker when you log in</code></li>
<li>Toggle on <code>Automatically check for updates</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-settings-general.png" alt="docker-settings-general" /></p>

<ul>
<li>After a minute or two, you should see <code>Docker is running</code> with a green circle.</li>
</ul>

<h2 id="step-3-kubernetes">Step 3: Kubernetes</h2>

<ul>
<li><p>Ensure Docker is running by completing <a href="#step-2-docker">Step 2: Docker</a> above.</p></li>

<li><p>Open the Docker menu by right clicking the Docker icon in the taskbar tray and selecting <code>Settings</code>.</p></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-tray-icon-settings.png" alt="docker-tray-icon-settings" /></p>

<ul>
<li>On the <code>Advanced</code> tab:

<ul>
<li>Set CPUs: 2</li>
<li>Set Memory: 4.0GiB</li>
<li>Set Swap: 512MiB</li>
<li>Click <code>Apply</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-settings-advanced.png" alt="docker-settings-kubernetes" /></p>

<ul>
<li>On the <code>Kubernetes</code> tab:

<ul>
<li>Toggle on <code>Enable Kubernetes</code>.</li>
<li>Click the <code>Kubernetes</code> radio button under <code>Default orchestrator for &quot;docker stack&quot; commands</code>.</li>
<li>Toggle on <code>Show system containers (advanced)</code>.</li>
<li>Click <code>Apply</code>.</li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-settings-kubernetes.png" alt="docker-settings-kubernetes" /></p>

<ul>
<li>When prompted with &ldquo;Kubernetes cluster installation&rdquo;, accept by clicking <code>Install</code></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-kubernetes-install-dialog.png" alt="docker-kubernetes-install-dialog" /></p>

<ul>
<li>Wait for the &ldquo;Installation Complete!&rdquo; dialog, and click <code>Close</code></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/docker-kubernetes-install-complete.png" alt="docker-kubernetes-install-complete" /></p>

<ul>
<li>Once Kubernetes is ready, you will see <code>Kubernetes is running</code>.</li>
</ul>

<div class="admonition note">
<p class="admonition-title"></p>
<p>We&rsquo;ll explore Kubernetes more later in this guide from inside of a
<a href="https://github.com/cisco-sso/kdk">Kubernetes Development Kit (KDK)</a> container.</p>
</div>

<h2 id="step-4-keybase">Step 4: Keybase</h2>

<div class="admonition note">
<p class="admonition-title"></p>
<p><p><br/>
<b>
<lu>
<li> Installation of Keybase is optional, and not necessary in order to complete the tutorial.</li>
<li> Installing Keybase is highly recommended, especially if you are working with a team that needs to share secrets (i.e. ssh keys required to access the bastion jumphost of the kubernetes cluster)</li>
</lu>
</b></p>

<p><a href="https://keybase.io/">Keybase</a> makes sharing secrets with your team <strong>much</strong> easier. A Keybase user may be added to one
or more <a href="https://keybase.io/docs/teams/index">Keybase Teams</a>, at which point the team&rsquo;s secret files are accessible
under your local filesystem at <code>k:</code>. Scripts and automation may then locate secrets
within the Keybase filesystem at common paths.</p>

<p>Later in this guide (upon <code>kdk init</code>), the kdk command will detect if keybase is present and then prompt the user to
mount the host&rsquo;s Keybase filesytem to the KDK container at <code>/keybase</code>.</p>

<p>Register a userid at <a href="https://keybase.io/">keybase.io</a> displaying your full name.  Be a good Keybase citizen and ensure
you are publish at least one verification.</p>

<p>Ask your team lead to add you to relevant Keybase teams. This will allow you to access team files at
<code>k:/team/&lt;team-name&gt;</code>.</p>
</p>
</div>

<h3 id="install-keybase">Install Keybase.</h3>

<pre><code class="language-bash"># Windows Powershell as Administrator
choco install -y keybase
</code></pre>

<h3 id="open-keybase">Open Keybase.</h3>

<ul>
<li><code>Windows Search</code> -&gt; <code>keybase</code></li>
<li>Login using your <a href="https://keybase.io/">keybase.io</a> credentials and authorize the client.</li>
</ul>

<h3 id="enable-keybase-files">Enable Keybase Files.</h3>

<ul>
<li><code>Settings</code> -&gt; <code>Files</code> -&gt; <code>Enable Keybase in Explorer</code></li>
</ul>

<h3 id="verify-that-keybasefs-is-mounted-to-your-system">Verify that KeybaseFS is mounted to your system.</h3>

<pre><code class="language-bash"># Windows Powershell
dir k:
## private  public  team
</code></pre>

<h2 id="step-5-kdk">Step 5: KDK</h2>

<div class="admonition note">
<p class="admonition-title"></p>
<p>The KDK CLI creates a Docker container with many tools already installed and ready for you to develop with Kubernetes.</p>
</div>

<p><h3 id="install-prerequisites">Install Prerequisites</h3>

<pre><code class="language-bash"># Windows Powershell as Administrator
choco install openssh
</code></pre>

<h3 id="install-the-kubernetes-development-kit-kdk-https-github-com-cisco-sso-kdk">Install the <a href="https://github.com/cisco-sso/kdk">Kubernetes Development Kit (KDK)</a>.</h3>

<pre><code class="language-bash"># Windows Powershell - NOT AS ADMINISTRATOR
Set-ExecutionPolicy Bypass -Scope Process -Force
iex ((New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/cisco-sso/kdk/master/files/install.ps1'))
</code></pre>

<h3 id="print-kdk-usage-information">Print KDK usage information.</h3>

<pre><code class="language-bash">kdk
</code></pre>

<h3 id="configure-kdk">Configure KDK.</h3>

<p>When running <code>kdk init</code>, please accept when prompted</p>

<p>Please respond affirmatively when prompted for:</p>

<ul>
<li>Keybase directory mounting</li>
<li>Enabling the SOCKS proxy at default port 8000</li>
</ul>

<pre><code class="language-bash">kdk init
</code></pre>

<h3 id="synchronize-kdk-container-with-docker-for-desktop-kubeconfig">Synchronize KDK container with Docker for Desktop KUBECONFIG.</h3>

<p>The prior install of Kubernetes on the local host machine create a KUBECONFIG file at <code>~/.kube/config</code> which contains
the auth credenials for accessing the local kubernetes cluster.  Since we want to do all operations from within the KDK,
we must copy the host&rsquo;s default KUBECONFIG into the KDK, and modify the docker-for-desktop configuration to work from
within the kdk.</p>

<pre><code class="language-bash">kdk kubesync
</code></pre>

<h3 id="run-the-kdk-container-and-log-into-it">Run the KDK container and log into it.</h3>

<pre><code class="language-bash">kdk ssh
</code></pre>
</p>

<h2 id="step-6-framework-deploy">Step 6: Framework Deploy</h2>

<div class="admonition note">
<p class="admonition-title"></p>
<p><a href="https://github.com/cisco-sso/framework-deploy">Framework-deploy</a> is a git repo which implments the KDF deployment
pattern. The boilerplate structure in framework-deploy is made to fit perfectly with the tools available in the KDK
container.  One may fork this repo as a basis for implementing the framework-deploy pattern for private kubernetes
clusters.</p>
</div>

<h3 id="clone-the-framework-deploy-https-github-com-cisco-sso-framework-deploy-repo-using-git">Clone the <a href="https://github.com/cisco-sso/framework-deploy">framework-deploy</a> repo using git.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`
#### Run this command if you have configured your GitHub account for public key SSH.
git clone git@github.com:cisco-sso/framework-deploy.git

#### (OR) Run this command if you have not configured GitHub for public key SSH.
git clone https://github.com/cisco-sso/framework-deploy.git
</code></pre>

<h3 id="change-to-the-framework-deploy-directory">Change to the <code>framework-deploy</code> directory.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`
cd framework-deploy/
## direnv: error .envrc is blocked. Run `direnv allow` to approve its content.
direnv allow
</code></pre>

<h3 id="take-a-look-around-framework-deploy">Take a look around framework-deploy.</h3>

<pre><code class="language-bash"># Important Files
.
├── apps
├── bin
├── clusters
└── .envrc
</code></pre>

<ul>
<li><code>clusters</code></li>
</ul>

<p>The <code>clusters</code> directory contains a directory for each Kubernetes cluster managed with framework-deploy. By entering the
<code>clusters/docker-for-desktop.example.org</code> directory, the system automatically configures all tools to operate on the
<code>docker-for-desktop.example.org</code> Kubernetes cluster that was spun up earlier in this tutorial.</p>

<p>In the framework-deploy pattern, the cluster directory, kubernetes context, and KUBECONFIG filename are all set to match
the cluster&rsquo;s external FQDN (e.g. <code>myorg1-dev.example.org</code>). This naming convention enables framework-deploy automation
to simplify interactive cluster usage.</p>

<ul>
<li><code>apps</code></li>
</ul>

<p>The <code>apps</code> directory contains template files for the <a href="https://github.com/cisco-sso/mh">mh</a> command. The values from the
<code>mh/main.yaml</code> inside of a cluster directory are applied to an &ldquo;app&rdquo; template file, producing custom configuration
overrides for a particular Helm chart.</p>

<ul>
<li><code>bin</code></li>
</ul>

<p>The <code>bin</code> directory contains scripts that simplify specific operations. For example, <code>bin/get-password-grafana.sh</code> is a
helper script that retrieves the auto-generated admin password for <a href="https://grafana.com/">grafana</a> from the kubernetes
secret as installed by framework-deploy.</p>

<ul>
<li><code>.envrc</code></li>
</ul>

<p>Upon entering a directory that contains an <code>.envrc</code> file, the <code>direnv</code> tool installed within the KDK container will
automatically source the <code>.envrc</code> file if it is present.</p>

<p>If <code>direnv</code> encounters an <code>.envrc</code> file it has not previously processed, or one that has changed since last seen,
<code>direnv</code> will prompt you to approve the processing of its content.  If you approve, run <code>direnv allow</code>.</p>

<h3 id="change-to-the-clusters-docker-for-desktop-example-org">Change to the <code>clusters/docker-for-desktop.example.org</code></h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`
cd clusters/docker-for-desktop.example.org
## direnv: error .envrc is blocked. Run `direnv allow` to approve its content.
direnv allow
</code></pre>

<h3 id="take-a-look-around-the-clusters-docker-for-desktop-example-org-directory">Take a look around the <code>clusters/docker-for-desktop.example.org</code> directory.</h3>

<pre><code class="language-bash"># Important Files
.
├── .envrc
├── mh
│   └── main.yaml
└── vars.yaml
</code></pre>

<ul>
<li><code>mh/main.yaml</code></li>
</ul>

<p>Inside of a cluster directory, the values from the <code>mh/main.yaml</code> file are applied to an &ldquo;app&rdquo; template file, producing
custom configuration overrides for a particular Helm chart.  The <a href="https://github.com/cisco-sso/mh">mh</a> tool, which ships
with the KDK container image, applies the template transformations to produce helm chart overrides, piping the result to
helm which then produces resource definitions which are loaded into kubernetes.  The <code>mh</code> tool is a variation of <a href="https://docs.helm.sh/developing_charts/#complex-charts-with-many-dependencies">helm
umbrella charts</a>, explained
<a href="https://kdf.csco.cloud/tools/#mh">here</a></p>

<ul>
<li><code>vars.yaml</code></li>
</ul>

<p>In the framework-deploy pattern, upon entering this directory, the direnv tool sources the <code>.envrc</code> file which then
reads configuration settings out of <code>vars.yaml</code>, ultimately setting enviroment variables to configure tools.</p>

<h3 id="interact-with-kubernetes-using-kubectl-https-kubernetes-io-docs-reference-kubectl-overview">Interact with Kubernetes using <a href="https://kubernetes.io/docs/reference/kubectl/overview/">kubectl</a>.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

kubectl config get-contexts
## CURRENT  NAME                            CLUSTER                         AUTHINFO                        NAMESPACE
## *        docker-for-desktop.example.org  docker-for-desktop.example.org  docker-for-desktop.example.org

kubectl config current-context
## docker-for-desktop.example.org

kubectl version
## Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;11&quot;, GitVersion:&quot;v1.11.1&quot;, GitCommit:&quot;b1b29978270dc22fecc592ac55d903350454310a&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2018-07-18T11:36:43Z&quot;, GoVersion:&quot;go1.10.3&quot;, Compiler:&quot;gc&quot;, Platform:&quot;darwin/amd64&quot;}
## Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;10&quot;, GitVersion:&quot;v1.10.3&quot;, GitCommit:&quot;2bba0127d85d5a46ab4b778548be28623b32d0b0&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2018-05-21T09:05:37Z&quot;, GoVersion:&quot;go1.9.3&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}

kubectl get nodes
## NAME                 STATUS    ROLES     AGE       VERSION
## docker-for-desktop   Ready     master     1h       v1.10.3

kubectl get statefulsets --all-namespaces
## No resources found.

kubectl get deployments --all-namespaces
## NAMESPACE     NAME          DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
## docker        compose       1         1         1            1           21h
## docker        compose-api   1         1         1            1           21h
## kube-system   kube-dns      1         1         1            1           21h

kubectl get pod --all-namespaces
## NAMESPACE     NAME                                         READY     STATUS    RESTARTS   AGE
## docker        compose-7447646cf5-gbcrx                     1/1       Running   0          1h
## docker        compose-api-6fbc44c575-gd92f                 1/1       Running   0          1h
## kube-system   etcd-docker-for-desktop                      1/1       Running   1          1h
## kube-system   kube-apiserver-docker-for-desktop            1/1       Running   1          1h
## kube-system   kube-controller-manager-docker-for-desktop   1/1       Running   1          1h
## kube-system   kube-dns-86f4d74b45-snz5s                    3/3       Running   0          1h
## kube-system   kube-proxy-dmqvq                             1/1       Running   0          1h
## kube-system   kube-scheduler-docker-for-desktop            1/1       Running   1          1h
</code></pre>

<h3 id="initialize-helm-tiller-https-docs-helm-sh-glossary-tiller-into-your-local-kubernetes-cluster">Initialize <a href="https://docs.helm.sh/glossary/#tiller">Helm Tiller</a> into your local Kubernetes cluster.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

helm version
## Client: &amp;version.Version{SemVer:&quot;v2.10.0&quot;, GitCommit:&quot;9ad53aac42165a5fadc6c87be0dea6b115f93090&quot;, GitTreeState:&quot;clean&quot;}
## Error: could not find tiller

helm init --wait
## $HELM_HOME has been configured at /home/&lt;you&gt;/.helm.
##
## Tiller (the Helm server-side component) has been installed into your Kubernetes Cluster.
##
## Please note: by default, Tiller is deployed with an insecure 'allow unauthenticated users' policy.
## To prevent this, run `helm init` with the --tiller-tls-verify flag.
## For more information on securing your installation see: https://docs.helm.sh/using_helm/#securing-your-helm-installation
## Happy Helming!

helm version
## Client: &amp;version.Version{SemVer:&quot;v2.10.0&quot;, GitCommit:&quot;9ad53aac42165a5fadc6c87be0dea6b115f93090&quot;, GitTreeState:&quot;clean&quot;}
## Server: &amp;version.Version{SemVer:&quot;v2.10.0&quot;, GitCommit:&quot;9ad53aac42165a5fadc6c87be0dea6b115f93090&quot;, GitTreeState:&quot;clean&quot;}
</code></pre>

<h3 id="simulate-https-github-com-cisco-sso-mh-simulate-app-upgrades-or-simulate-install-of-apps-as-needed-the-deployment-of-kdf-apps-using-mh"><a href="https://github.com/cisco-sso/mh#simulate-app-upgrades-or-simulate-install-of-apps-as-needed">Simulate</a> the deployment of KDF apps using mh.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`
mh simulate --printRendered
## ...
</code></pre>

<h3 id="apply-https-github-com-cisco-sso-mh-apply-app-upgrades-or-install-apps-as-needed-the-deployment-of-kdf-apps-using-mh"><a href="https://github.com/cisco-sso/mh#apply-app-upgrades-or-install-apps-as-needed">Apply</a> the deployment of KDF apps using mh.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`
mh apply
## ...
</code></pre>

<h3 id="inspect-the-resulting-helm-releases">Inspect the resulting Helm releases.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

helm ls
## NAME                   REVISION UPDATED                  STATUS   CHART                        APP VERSION NAMESPACE
## chaoskube              1        Thu Sep 27 15:37:53 2018 DEPLOYED chaoskube-0.8.0              0.8.0       default
## elasticsearch          1        Thu Sep 27 15:37:40 2018 DEPLOYED elasticsearch-1.4.0          6.3.1       default
## elasticsearch-exporter 1        Thu Sep 27 15:37:42 2018 DEPLOYED elasticsearch-exporter-0.2.0 1.0.2       default
## filebeat               1        Thu Sep 27 15:37:47 2018 DEPLOYED filebeat-0.6.0               6.3.1       default
## grafana                1        Thu Sep 27 15:37:51 2018 DEPLOYED grafana-1.13.1               5.1.3       default
## kibana                 1        Thu Sep 27 15:37:45 2018 DEPLOYED kibana-0.8.0                 6.3.1       default
## nginx-ingress-external 1        Thu Sep 27 15:37:43 2018 DEPLOYED nginx-ingress-0.23.0         0.15.0      default
## prometheus             1        Thu Sep 27 15:37:48 2018 DEPLOYED prometheus-7.0.0             2.3.2       default
</code></pre>

<h3 id="use-the-watch-https-linux-die-net-man-1-watch-command-to-monitor-the-status">Use the <a href="https://linux.die.net/man/1/watch">watch</a> command to monitor the status.</h3>

<p>(Use <code>CTRL + c</code> to exit the watch command loop.)</p>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

watch -n1 'kubectl get pod'
## Every 1.0s: kubectl get pod
##
## NAME                                                            READY     STATUS              RESTARTS   AGE
## chaoskube-chaoskube-7f5874cc98-nvksz                            0/1       ContainerCreating   0          9s
## elasticsearch-client-7cdc657767-p9kzq                           0/1       PodInitializing     0          22s
## elasticsearch-data-0                                            0/1       Init:1/2            0          22s
## elasticsearch-exporter-elasticsearch-exporter-659975bf4-b75sf   1/1       Running             0          20s
## elasticsearch-master-0                                          0/1       Init:0/2            0          22s
## filebeat-dvgd8                                                  0/1       ContainerCreating   0          15s
## grafana-599bd6c66-fqf98                                         0/1       Init:0/1            0          11s
## kibana-5f66c65c47-6nttz                                         0/1       ContainerCreating   0          17s
## nginx-ingress-external-controller-dd7775d7f-clflh               0/1       ContainerCreating   0          19s
## nginx-ingress-external-default-backend-744cd584cf-drxx9         0/1       ContainerCreating   0          19s
## prometheus-alertmanager-6bfdc4b7f4-4wtxl                        0/2       ContainerCreating   0          13s
## prometheus-kube-state-metrics-6584885ccf-l7lnz                  0/1       ContainerCreating   0          13s
## prometheus-node-exporter-zzz5b                                  0/1       ContainerCreating   0          13s
## prometheus-pushgateway-d5fdc4f5b-wjzdt                          0/1       ContainerCreating   0          13s
## prometheus-server-5c969bc49c-jm9fl                              0/2       PodInitializing     0          13s
</code></pre>

<h3 id="you-should-soon-see-that-all-pods-are-running-and-ready">You should soon see that all pods are running and ready.</h3>

<pre><code class="language-bash">## Every 1.0s: kubectl get pod
##
## NAME                                                            READY     STATUS    RESTARTS   AGE
## chaoskube-chaoskube-7f5874cc98-nvksz                            1/1       Running   0          21m
## elasticsearch-client-7cdc657767-p9kzq                           1/1       Running   0          21m
## elasticsearch-data-0                                            1/1       Running   0          21m
## elasticsearch-exporter-elasticsearch-exporter-659975bf4-b75sf   1/1       Running   0          21m
## elasticsearch-master-0                                          1/1       Running   0          21m
## elasticsearch-master-1                                          1/1       Running   0          18m
## filebeat-dvgd8                                                  1/1       Running   0          21m
## grafana-599bd6c66-fqf98                                         1/1       Running   0          21m
## kibana-5f66c65c47-6nttz                                         1/1       Running   0          21m
## nginx-ingress-external-controller-dd7775d7f-clflh               1/1       Running   0          21m
## nginx-ingress-external-default-backend-744cd584cf-drxx9         1/1       Running   0          21m
## prometheus-alertmanager-6bfdc4b7f4-4wtxl                        2/2       Running   0          21m
## prometheus-kube-state-metrics-6584885ccf-l7lnz                  1/1       Running   0          21m
## prometheus-node-exporter-zzz5b                                  1/1       Running   0          21m
## prometheus-pushgateway-d5fdc4f5b-wjzdt                          1/1       Running   0          21m
## prometheus-server-5c969bc49c-jm9fl                              2/2       Running   0          21m
</code></pre>

<h3 id="get-a-list-of-kubernetes-ingress-https-kubernetes-io-docs-concepts-services-networking-ingress-resources">Get a list of <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Kubernetes Ingress</a> resources.</h3>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

kubectl get ingress
## NAME                      HOSTS                                         ADDRESS     PORTS     AGE
## grafana                   grafana.docker-for-desktop.example.org        localhost   80        21m
## kibana                    kibana.docker-for-desktop.example.org         localhost   80        21m
## prometheus-alertmanager   alertmanager.docker-for-desktop.example.org   localhost   80        21m
## prometheus-pushgateway    pushgateway.docker-for-desktop.example.org    localhost   80        21m
## prometheus-server         prometheus.docker-for-desktop.example.org     localhost   80        21m
</code></pre>

<h3 id="http-get-an-api-behind-a-kubernetes-ingress-resource">HTTP GET an API behind a Kubernetes Ingress resource.</h3>

<p>This <a href="https://curl.haxx.se/">curl</a> command performs an HTTP GET against the <a href="https://prometheus.io/docs/prometheus/latest/querying/api/">Prometheus API</a> which is exposed by the <a href="https://github.com/kubernetes/ingress-nginx">nginx-ingess</a>. Note how the host header is used for ingress routing.</p>

<pre><code class="language-bash"># Within your KDK container via `kdk ssh`

curl -fsSL \
  --header 'Host: prometheus.docker-for-desktop.example.org' \
  http://host.docker.internal/api/v1/label/__name__/values \
  | jq '.status'
## &quot;success&quot;
</code></pre>

<p>It is also possible to visit ingress endpoints in the broswer on your host machine. However, you&rsquo;ll need to include
<a href="https://en.wikipedia.org/wiki/Hosts_(file)">hosts</a> file lines to ensure the ingress host names resolve properly to
<code>127.0.0.1</code>. We plan to add documentation to simplify and clarify how this is done.</p>


<h2 id="step-7-explore-kubernetes">Step 7: Explore Kubernetes</h2>

<div class="admonition note">
<p class="admonition-title"></p>
<p>In this section, explore your newly provisioned Kubernetes cluster along with all of the basic services you have
deployed via the <a href="https://github.com/cisco-sso/framework-deploy">framework-deploy</a> code repository.  You will connect to
the admin panels of the services you have deployed.  Connecting to these admin panels requires a web browser which is
configured to use the KDK as a <a href="https://en.wikipedia.org/wiki/SOCKS">SOCKS</a> proxy.  The KDK will proxy all web requests
to the internal ingress, so that one may access the dashboards using the configured cluster DNS name
(*.docker-for-desktop.example.org).</p>
</div>

<h3 id="open-up-a-socks-connection-by-connecting-to-your-kdk">Open up a SOCKS connection by connecting to your KDK</h3>

<pre><code># Host machine shell
kdk ssh
</code></pre>

<h3 id="install-firefox">Install Firefox</h3>

<p>We prefer Firefox because it allows one to manage network proxy configurations independently of the host operating
system.</p>

<p>Download Firefox <a href="https://www.mozilla.org/en-US/firefox/new/">here</a> or install it through a prior-installed package
manager as prior steps have demonstrated.</p>

<h3 id="configure-your-web-browser-to-connect-via-the-kdk-socks-proxy">Configure your web browser to connect via the KDK SOCKS proxy</h3>

<p>It may be beneficial to start Firefox with the profile manager so that you can keep these settings separate from the
default instance.  Start the profile manager by adding the <code>-P</code> option on the command line.  See this
<a href="https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles">link</a> for instructions.</p>

<p>Firefox -&gt; <code>General</code> -&gt; <code>Network Proxy</code> -&gt; Click <code>Settings</code></p>

<ul>
<li>In the Settings window:

<ul>
<li>Toggle on <code>Manual proxy configuration</code></li>
<li>Enter SOCKS Host value &ldquo;127.0.0.1&rdquo;</li>
<li>Enter SOCKS Port value &ldquo;8000&rdquo;</li>
<li>Toggle on <code>SOCKS v5</code></li>
<li>Toggle on <code>Proxy DNS when using SOCKS v5</code></li>
<li>Click <code>OK</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/firefox-settings-socks.png" alt="firefox-settings-socks" /></p>

<h3 id="once-firefox-has-been-started-you-may-access-all-of-the-admin-panels">Once Firefox has been started, you may access all of the admin panels</h3>

<p>The following links will work if you have successfully setup the KDK SOCKS proxy with Firefox.</p>

<div hidden comment>$ kubectl get ing| grep -v HOSTS| awk '{print "http://" $2}'</div>

<p>Kibana</p>

<ul>
<li><a href="http://kibana.docker-for-desktop.example.org">http://kibana.docker-for-desktop.example.org</a></li>
</ul>

<p>Grafana</p>

<ul>
<li><a href="http://grafana.docker-for-desktop.example.org">http://grafana.docker-for-desktop.example.org</a></li>
</ul>

<p>Prometheus</p>

<ul>
<li><a href="http://prometheus.docker-for-desktop.example.org">http://prometheus.docker-for-desktop.example.org</a></li>
<li><a href="http://alertmanager.docker-for-desktop.example.org">http://alertmanager.docker-for-desktop.example.org</a></li>
</ul>

<h3 id="warning">Warning</h3>

<p>The rest of this section assumes that you have successfully properly setup your SOCKS proxy and web browser, and can
reach the links mentioned prior.</p>

<h3 id="explore-kibana">Explore Kibana</h3>

<p>Kibana is a view into Elasticsearch, where all logs in the Kubernetes system are forwarded.</p>

<ul>
<li>Go to the Kibana admin panel:

<ul>
<li><a href="http://kibana.docker-for-desktop.example.org">http://kibana.docker-for-desktop.example.org</a></li>
</ul></li>
<li>Configure Kibana so it will show you logs:

<ul>
<li>Click the <code>Management</code> tab</li>
<li>Under Step 1 of 2: Define index pattern</li>
<li>Set Index pattern: <code>filebeat-*</code></li>
<li>A message with &ldquo;Success!  Your index pattern matches&rdquo; should appear</li>
<li>Click <code>Next Step</code></li>
<li>Under Step 2 of 2: Configure Settings</li>
<li>Set the Time Filter field name: <code>@timestamp</code></li>
<li>Click <code>Create index pattern</code></li>
</ul></li>
<li>View system logs:

<ul>
<li>Click the <code>Discover</code> tab</li>
<li>Now you should see system logs.</li>
<li>For more information on Kibana searches, see the <a href="https://www.elastic.co/guide/en/kibana/current/search.html">official documentation</a></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/admin-panel-kibana.png" alt="admin-panel-kibana" /></p>

<h3 id="explore-grafana">Explore Grafana</h3>

<ul>
<li>Go to the Grafana admin panel:

<ul>
<li><a href="http://grafana.docker-for-desktop.example.org">http://grafana.docker-for-desktop.example.org</a></li>
</ul></li>
<li>View the &ldquo;Elasticsearch&rdquo; Dashboard:

<ul>
<li>Select <code>Home</code> -&gt; <code>ElasticSearch</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/admin-panel-grafana-elasticsearch.png" alt="admin-panel-grafana-elasticsearch" /></p>

<ul>
<li>View the &ldquo;Kubernetes Cluster Monitoring&rdquo; Dashboard:

<ul>
<li>Select <code>Home</code> -&gt; <code>Kubernetes Cluster Monitoring</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/admin-panel-grafana-kubernetes.png" alt="admin-panel-grafana-kubernetes" /></p>

<h3 id="explore-prometheus">Explore Prometheus</h3>

<ul>
<li>Go to the Prometheus admin panel:

<ul>
<li><a href="http://prometheus.docker-for-desktop.example.org">http://prometheus.docker-for-desktop.example.org</a></li>
</ul></li>
<li>Create a graph of pod memory usage

<ul>
<li>Click <code>Graph</code></li>
<li>Enter Expression:</li>
</ul></li>
</ul>

<pre><code>sum (container_memory_working_set_bytes{image!=&quot;&quot;,name=~&quot;^k8s_.*&quot;}) by (pod_name)
</code></pre>

<p><img src="https://kdf.csco.cloud/images/admin-panel-prometheus.png" alt="admin-panel-prometheus" /></p>

<h3 id="explore-prometheus-alertmanager">Explore Prometheus Alertmanager</h3>

<ul>
<li>Go to the Prometheus Alertmanager admin panel:

<ul>
<li><a href="http://alertmanager.docker-for-desktop.example.org">http://alertmanager.docker-for-desktop.example.org</a></li>
</ul></li>
<li>From the default landing page you may view all currently firing alerts</li>
</ul>

<p><img src="https://kdf.csco.cloud/images/admin-panel-prometheus-alertmanager.png" alt="admin-panel-prometheus-alertmanager" /></p>


<h2 id="post-install">Post-Install</h2>

<p><em>(optional)</em></p>

<h3 id="add-your-public-ssh-key-to-source-control-systems">Add your public SSH key to source control systems.</h3>

<p>This is optional if you are using <a href="https://developer.github.com/v3/guides/using-ssh-agent-forwarding/">ssh-agent</a>, which
the KDK automatically forwards.  Otherwise, you may directly configure the pre-generated ssh key which is used to
connect to the KDK, within each source control provider.</p>

<p>Add content of ssh public key <code>~/.kdk/ssh/id_rsa.pub</code></p>

<ul>
<li>To your <a href="https://github.com/settings/keys">Github Account Keys</a></li>
<li>To your Bitbucket Server https://&lt;BITBUCKET-SERVER&gt;/bitbucket/plugins/servlet/ssh/account/keys</li>
</ul>

<h3 id="customing-your-bash-profile">Customing your <code>.bash_profile</code></h3>

<p>If you have installed <a href="https://keybase.io/">Keybase</a>, you may customize your bash profile by creating the file
<code>/keybase/private/&lt;user-keybase-id&gt;/.bash_profile_private</code>.  The default KDK
<a href="https://github.com/cisco-sso/yadm-dotfiles/blob/master/.bash_profile#L101"><code>.bash_profile</code></a> will automatically source
the <code>.bash_profile_private</code> file from keybase, if it exists.</p>

<h3 id="customizing-your-dotfiles">Customizing your dotfiles</h3>

<p>If you have your own yadm dotfiles repository, you may <code>kdk init</code> with the option:</p>

<pre><code>--dotfiles-repo string      KDK Dotfiles Repo (default &quot;https://github.com/cisco-sso/yadm-dotfiles.git&quot;)
</code></pre>

<p>The easiest way to create a compatible dotfiles repository is to fork the repository
<a href="https://github.com/cisco-sso/yadm-dotfiles.git">yadm-dotfiles</a>.</p>


<h2 id="uninstall-cleanup">Uninstall &amp; Cleanup</h2>

<div class="admonition note">
<p class="admonition-title"></p>
<p>This section documents a graceful deletion of resources.  Quicker shortcuts do exist.</p>
</div>

<h3 id="delete-all-kubernetes-resources">Delete all Kubernetes Resources</h3>

<p>This will delete all running pods and persistent volume state</p>

<pre><code class="language-bash"># From within the KDK: `kdk ssh`
cd framework-deploy/clusters/docker-for-desktop.example.org
## direnv: error .envrc is blocked. Run `direnv allow` to approve its content.
direnv allow
## ...

helm delete --purge $(helm ls| cut -d ' ' -f 1| grep -v NAME)
## release &quot;chaoskube&quot; deleted
## release &quot;elasticsearch&quot; deleted
## release &quot;elasticsearch-exporter&quot; deleted
## release &quot;filebeat&quot; deleted
## release &quot;grafana&quot; deleted
## release &quot;kibana&quot; deleted
## release &quot;nginx-ingress-external&quot; deleted
## release &quot;prometheus&quot; deleted
## // A shortcut command `mh destroy` is equivalent to the above

kubectl delete pvc $(kubectl get pvc| cut -d ' ' -f 1| grep -v NAME)
## persistentvolumeclaim &quot;data-elasticsearch-data-0&quot; deleted
## persistentvolumeclaim &quot;data-elasticsearch-master-0&quot; deleted
## persistentvolumeclaim &quot;data-elasticsearch-master-1&quot; deleted
## persistentvolumeclaim &quot;data-test-mariadb-mariadb-master-0&quot; deleted
## persistentvolumeclaim &quot;data-test-mariadb-mariadb-slave-0&quot; deleted
</code></pre>


<h3 id="uninstall-docker-for-windows">Uninstall Docker for Windows</h3>

<ul>
<li><p>Open &ldquo;Add Or Remove Programs&rdquo; through the Windows start menu search:
<img src="https://kdf.csco.cloud/images/windows/windows-start-add-or-remove-programs.png" alt="windows-start-add-or-remove-programs" /></p></li>

<li><p>In the &ldquo;Apps &amp; Features&rdquo; Search box:</p>

<ul>
<li>Enter: <code>docker</code></li>
<li>Click <code>Uninstall</code></li>
</ul></li>
</ul>

<p><img src="https://kdf.csco.cloud/images/windows/windows-add-or-remove-programs-docker.png" alt="windows-add-or-remove-programs-docker" /></p>

<h3 id="delete-leftover-docker-and-kubernetes-state">Delete leftover Docker and Kubernetes state</h3>

<pre><code># Windows Powershell on Host machine
del -r ~/.docker ~/.kube
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2018 Released under the Apache-2.0 license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://kdf.csco.cloud/getting-started/mac/" title="Getting Started &gt; Mac">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Getting Started &gt; Mac
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://kdf.csco.cloud/kubernetes/helm-charts/" title="Helm Charts">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Helm Charts
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/kdf.csco.cloud\/';
      var repo_id  = 'cisco-sso\/kdf';
    
    </script>

    <script src="https://kdf.csco.cloud/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-129018255-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

